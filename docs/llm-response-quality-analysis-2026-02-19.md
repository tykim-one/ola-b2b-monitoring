# LLM 응답 품질 분석 보고서

> **분석일**: 2026-02-19  
> **분석 기간**: 2026-01-27 ~ 2026-02-19 (24일간)  
> **데이터 소스**: `finola-global.ola_monitoring.view_ola_monitoring`  
> **전체 대화 건수**: 12,777건 (1/27 이후)  
> **실패 응답 건수**: 683건 (5.35%)

---

## 1. Executive Summary

최근 24일간 전체 대화의 **5.35%** (683건)가 사용자 질문에 제대로 답변하지 못한 것으로 분류되었습니다. 이 중 대부분은 **고정 템플릿 응답**으로, LLM이 질문 맥락을 분석하지 않고 기계적으로 거절하는 패턴이 지배적입니다.

### 핵심 발견사항

| 우선순위 | 발견 | 영향도 |
|---------|------|--------|
| 🔴 **Critical** | Type A 투자추천 거절 템플릿이 **정당한 정보 요청까지** 차단 (오탐률 ~62%) | 일 평균 9.6건 |
| 🔴 **Critical** | Type B 도메인 외 거절이 **증권사 업무/금융상품 문의**를 거절 (오탐률 ~36%) | 일 평균 10.3건 |
| 🟡 **High** | Type C 범위 넓어 템플릿이 **구체적 질문도** 동일 거절 (오탐률 ~15%) | 일 평균 4.9건 |
| 🟡 **High** | Type D 이해불가 응답이 **오타/축약어** 포함 질문을 전부 거절 | 일 평균 3.0건 |
| 🟠 **Medium** | Type E 짧은 응답이 **종목명만 반환**하고 요청한 분석 미제공 | 일 평균 1.9건 |

---

## 2. 실패 유형 분류 및 상세 분석

### 2.1 전체 분포

```
전체 대화: 12,777건 (100%)
├── ✅ 정상 응답: 12,094건 (94.65%)
└── ❌ 실패 응답:   683건 ( 5.35%)
    ├── Type A. 투자추천 거절:  221건 (1.73%) ← 고정 템플릿
    ├── Type B. 도메인 외 거절: 236건 (1.85%) ← 고정 템플릿
    ├── Type C. 범위 넓어:      113건 (0.88%) ← 고정 템플릿
    ├── Type D. 이해 불가:       69건 (0.54%) ← 고정 템플릿
    └── Type E. 짧은 응답:       44건 (0.34%) ← 내용 부족
```

---

### 2.2 Type A — 투자추천 거절 (221건, 1.73%)

**고정 응답 템플릿:**
> "죄송합니다. 저는 법률 및 내부 규정에 따라 특정 종목을 추천하거나 개인적인 투자 자문을 제공할 수 없습니다. 저의 역할은 객관적인 사실과 데이터를 기반으로 정보를 제공하여 투자자님의 현명한 판단을 돕는 것입니다."

#### 질문 세부 분류

| 하위 유형 | 건수 | 비율 | 거절 적정성 |
|-----------|------|------|-----------|
| 투자추천/매매문의 | 60 | 27.1% | ✅ 적정 (법적 제한) |
| 주가전망/예측 | 12 | 5.4% | ✅ 적정 |
| 테마/관련주 | 8 | 3.6% | ⚠️ 과잉 (정보 제공 가능) |
| 투자전략 | 2 | 0.9% | ⚠️ 과잉 |
| 기업분석 요청 | 1 | 0.5% | ❌ 오탐 |
| **기타 (오분류)** | **138** | **62.4%** | ❌ **오탐** |

#### 🔴 오탐 사례 (답변 가능했던 질문들)

| 질문 | 왜 오탐인가 |
|------|-----------|
| "SK하이닉스와 삼성전자의 최근 재무 지표, 주요 뉴스, 애널리스트 의견" | **객관적 데이터 요청** — 추천 아님 |
| "국내 2000원대 주식 중 52주 신저가 종목 리스트와 재무상태" | **팩트 조회** — 추천 아님 |
| "국내 전력 관련 고배당주 중 배당 수익률이 높은 종목" | **데이터 정렬** — 추천이 아닌 사실 조회 |
| "지금 현재 수급 좀 알려줘" | **시장 데이터 조회** — 추천 아님 |
| "한컴위드 신용매수불가이유" | **거래 규칙 문의** — 투자 자문 아님 |
| "IBK 정권 수수료 얼마예요?" | **단순 업무 문의** — 완전 오탐 |
| "6G 관련 주요 기업들의 최근 뉴스 동향" | **뉴스/팩트 조회** — 추천 아님 |
| "알테오젠의 최근 투자 정보, 재무 지표, 주가 동향" | **종합 분석 요청** — 시스템 핵심 기능 |

#### 근본 원인

투자 관련 키워드 ("투자", "매수", "매도", "사고싶", "사는 방법" 등)의 **단순 매칭**으로 추천 여부를 판단하여, 키워드가 포함되었지만 실제로는 **객관적 정보/분석을 요청**하는 질문까지 일괄 거절.

---

### 2.3 Type B — 도메인 외 거절 (236건, 1.85%)

**고정 응답 템플릿:**
> "죄송합니다. 저는 금융 및 투자 정보 제공을 위한 금융 전문 챗봇으로, 요청하신 질문에는 답변을 드리기 어렵습니다."

#### 질문 세부 분류

| 하위 유형 | 건수 | 비율 | 거절 적정성 |
|-----------|------|------|-----------|
| **기타** | **129** | **54.7%** | ❌ 개별 확인 필요 |
| 증권사 업무문의 | 40 | 16.9% | ❌ **오탐** — 금융 도메인 |
| 거래/주문문의 | 27 | 11.4% | ❌ **오탐** — 핵심 업무 |
| 단어 수준 입력 | 21 | 8.9% | ⚠️ 이해 불가에 가까움 |
| 금융상품 문의 | 16 | 6.8% | ❌ **오탐** — 금융 도메인 |
| 시장/뉴스 문의 | 3 | 1.3% | ❌ **오탐** — 핵심 기능 |

#### 🔴 오탐 사례

| 질문 | 왜 오탐인가 |
|------|-----------|
| "주식거래수수료는" | **증권사 핵심 FAQ** |
| "시간외 거래 방법" | **거래 업무 안내** |
| "NH투자증권우선주 배당기준일" | **종목 데이터 조회** |
| "배당금찾는방법" | **증권사 업무 안내** |
| "공모주 설명해줘" | **금융 용어 설명** — 핵심 도메인 |
| "권리락은 뭐야?" | **금융 용어 설명** |
| "일양약품 거래중단 사유가 궁금해요" | **종목 이벤트 조회** |
| "IBK증권사 ISA 설명 부탁드려요" | **자사 상품 안내** — 고객 이탈 위험 |

#### 근본 원인

LLM이 "금융 정보 제공용"이라고 스스로를 규정하면서도, **증권사 업무/거래 안내/금융 용어 설명** 등 명백히 금융 도메인에 속하는 질문을 "도메인 외"로 오분류. 특히 **자사(IBK) 관련 문의**까지 거절하는 것은 고객 경험에 심각한 악영향.

---

### 2.4 Type C — "범위가 너무 넓어" (113건, 0.88%)

**고정 응답 템플릿:**
> "질문의 범위가 너무 넓어 명확한 답변을 드리기 어렵습니다. 조금 더 구체적으로 질문해 주시겠어요? 예를 들어, '삼성전자의 최근 3년간 매출 실적'과 같이..."

#### 질문 길이별 분포

| 입력 길이 | 건수 | 비율 | 대표 질문 |
|-----------|------|------|----------|
| 1~5자 | 35 | 31.0% | "손익", "합병결과", "시간외" |
| 6~10자 | 40 | 35.4% | "투자위험 언제풀려", "글자수 제안있나요?" |
| 11~20자 | 21 | 18.6% | "다원시스의 향후주가 전망은?" |
| 21~40자 | 16 | 14.2% | "성호전자와 비슷한 코스닥 종목은 뭐가 있나요?" |
| 40자+ | 1 | 0.9% | "앱튼(270520) 상장폐지 되면..." |

#### 🔴 문제점

- **1~10자 질문 (66.4%)**: 단어 수준 입력은 "범위가 넓다"가 아니라 **"맥락 부족"** 이 정확한 진단
- **11자+ 질문 (33.6%)**: "성호전자와 비슷한 코스닥 종목"처럼 **충분히 구체적인 질문**도 동일 템플릿으로 처리됨
- 유사한 질문("파인텍과 비슷한 코스닥 종목")은 **정상 답변**되었으므로, 이 템플릿은 **LLM 내부 판단 불일치**의 결과

#### 근본 원인

LLM이 데이터 검색에 실패했을 때 fallback으로 이 템플릿을 사용하는 것으로 추정. 질문의 구체성 자체가 문제가 아니라, **데이터 매칭 실패 시 일관되게 "범위 넓어" 템플릿을 반환**하는 구조적 문제.

---

### 2.5 Type D — 입력 이해 불가 (69건, 0.54%)

**고정 응답 템플릿:**
> "죄송합니다. 입력하신 내용을 정확히 이해하지 못했습니다. 확인 후 다시 질문해 주시겠어요?"

#### 대표 사례

| 질문 | 패턴 |
|------|------|
| "4247" | 숫자만 입력 |
| "Dl" | 의미 불명 |
| "컨텍" | 극도로 축약 |
| "네" | 단답형 (이전 대화 맥락 필요) |
| "계좌패쇠" | 오타 ("계좌폐쇄") |
| "시가퐁액" | 오타 ("시가총액") |
| "시간옥호가ㅊㄱㆍㅇ열어줘" | 오타+초성 섞임 |
| "스테이블코인 발읜" | 오타 ("발행") |
| "isa" | 약어 (충분히 인식 가능) |
| "CAM에 연결" | 비금융 용어 |

#### 근본 원인

1. **오타/맞춤법 오류** 보정 능력 부재 — "계좌패쇠"→"계좌폐쇄", "시가퐁액"→"시가총액" 수준의 보정 필요
2. **극단적 축약어** 처리 미흡 — "isa" 같은 흔한 약어는 인식해야 함
3. **세션 컨텍스트** 미활용 — "네"라는 답변은 이전 대화의 연장인데 독립 질문으로 처리

---

### 2.6 Type E — 짧은 응답 / 내용 부족 (44건, 0.34%)

**50자 이하의 불완전한 응답.**

#### 대표 사례

| 질문 | 응답 | 문제 |
|------|------|------|
| "기아자동차 목표주가?" | "- 기아 (000270, KOSPI)" | **종목명만 반환**, 목표주가 미제공 |
| "코스맥스 종합적으로 분석해줘" | "코스맥스(192820): KOSPI 상장, 거래 중" | **분석 없이 종목 존재 확인만** |
| "포스코엠택 주가전망" | "- 포스코엠텍(009520, KOSDAQ)" | 종목 정정만, 전망 미제공 |
| "최근 우주항공 관련 뉴스 주요 이슈?" | "데이터에 포함되어 있지 않습니다" | **22자 거절** — 안내 부족 |
| "증권주" | "증권주에 대한 데이터가 없습니다" | **22자 거절** — 대안 미제시 |

#### 근본 원인

LLM이 **종목 인식**까지는 성공했으나, 실제 데이터 조회/분석 파이프라인 연결이 끊어져 **종목 확인만 반환**하고 종료. 응답 품질 검증 (minimum length/content check) 부재.

---

## 3. 사후 불만 분석 (Post-Failure Frustration)

실패 응답 이후 **동일 세션**에서 부정적 반응이 확인된 사례:

| 원래 질문 | 챗봇 응답 유형 | 사용자 후속 반응 |
|-----------|---------------|----------------|
| "금 현물을 사고싶어" | Type A 거절 | "아니 사고싶다고 어떻게 사?" |
| ↑ 재질문 후에도 동일 거절 | Type A 거절 | **"아니 시발 사는 방법을 알려달라고"** |
| "오늘 큰 폭으로 내려가는데 가지고있어야하나?" | Type A 거절 | "그럼 오늘 왜 이렇게 빠지나?" |
| "다 아는 이야기인데 향후 어떻게 되나?" | Type A 거절 | "그럼 AI가 아니지" |
| "충전" | Type D 이해불가 | **"시발련아 돈 충전하고싶다고"** |
| "입금이 왜 안 돼?" | Type C 범위넓어 | "아니 지금 증권사에 입금이 왜 안 돼?" |
| "한국 전력을 지난주부터 계속 추천하는데" | Type A 거절 | "계속 떨어져 왜 추천하니?" |

### 핵심 인사이트

1. **"금 현물 사고싶어" 에스컬레이션**: 사용자는 **매매 방법**을 묻는 것인데, "투자 추천" 거절 템플릿이 3번 연속 반환 → 극심한 불만
2. **"충전" 오분류**: 계좌 충전(입금) 요청인데 "이해 불가" 처리 → 욕설 수준 불만
3. **반복 거절의 파괴력**: 같은 템플릿이 연속 반환되면 사용자 이탈/불만이 급격히 증가

---

## 4. 일별 트렌드

```
날짜       | Total | A | B | C | D | 실패율
-----------|-------|---|---|---|---|-------
2026-02-18 |   302 | 6 | 8 | 2 | 3 | 6.3%
2026-02-17 |   128 | 4 | 5 | 2 | 1 | 9.4%
2026-02-16 |   140 | 0 | 5 | 2 | 1 | 5.7%
2026-02-15 |   174 | 2 | 4 | 2 | 2 | 5.7%
2026-02-14 |   171 | 3 | 9 | 1 | 3 | 9.4%
2026-02-13 |   597 |13 |14 | 3 | 4 | 5.7%
2026-02-12 |   902 |10 |13 | 8 | 3 | 3.8%
2026-02-11 |   836 |14 |19 |19 | 2 | 6.5%
2026-02-10 |   742 | 8 |14 | 5 | 2 | 3.9%
2026-02-09 |   721 |13 | 8 | 3 | 0 | 3.3%
2026-02-08 |   294 | 8 | 7 | 3 | 2 | 6.8%
2026-02-07 |   257 | 5 | 6 | 0 | 1 | 4.7%
2026-02-06 |   482 | 6 |12 | 4 | 1 | 4.8%
2026-02-05 |   688 |12 | 9 | 7 | 4 | 4.7%
2026-02-04 |   919 |18 |11 |11 | 6 | 5.0%
2026-02-03 |   769 |12 |11 | 2 |10 | 4.6%
2026-02-02 |   591 |10 |12 | 9 |11 | 7.1%
2026-02-01 |   404 | 7 | 4 | 0 | 1 | 3.0%
2026-01-31 |   270 | 4 | 4 | 0 | 1 | 3.3%
2026-01-30 |   770 |12 |11 | 9 | 4 | 4.7%
2026-01-29 |   960 |12 |17 | 6 | 2 | 3.9%
2026-01-28 |   901 |26 |19 | 8 | 4 | 6.3%
2026-01-27 |   684 |14 |14 | 7 | 1 | 5.3%
```

**특이사항:**
- 1/26 이전에는 A~D 유형 0건 → **1/27에 새로운 가드레일 시스템 배포** 추정
- 1/28에 Type A 26건으로 피크 → 배포 직후 과잉 필터링 발생
- Type D는 2/2~2/3에 집중 (10, 11건) → 해당 기간 인코딩 또는 입력 파싱 이슈 가능성

---

## 5. 개선 방안

### 5.1 🔴 [즉시] Type A 투자추천 거절 로직 개선

**문제**: 단순 키워드 매칭으로 62%가 오탐  
**솔루션**: 2단계 판단 체계

```
Step 1: 질문 의도 분류 (Intent Classification)
  ├── "~해도 될까?", "~사야하나?" → 투자 자문 요청 → 거절 적정
  ├── "~재무 지표", "~뉴스 동향" → 정보 조회 요청 → 답변 제공
  ├── "~수수료", "~방법" → 업무 문의 → 답변 제공
  └── "~추천해줘" → 직접 추천 요청 → 거절 적정

Step 2: 거절 시에도 가능한 정보 제공
  "직접적인 투자 추천은 어렵지만, 해당 종목의 최근 재무 데이터와
   시장 동향을 안내드립니다: [실제 데이터]"
```

**기대 효과**: 오탐 221건 → ~84건 (-62%), 사용자 불만 대폭 감소

### 5.2 🔴 [즉시] Type B 도메인 판단 범위 확대

**문제**: 증권사 업무/거래/금융상품 질문을 "도메인 외"로 오분류  
**솔루션**: 

1. **금융 도메인 화이트리스트 확장**:
   - 증권사 업무: 수수료, 계좌, 이체, 비밀번호, 거래시간
   - 금융상품: 배당, ISA, 공모주, ETF, 펀드
   - 거래 안내: 매수/매도 방법, 주문, 시간외거래
   - 금융 용어: 권리락, 대용금, 시가총액

2. **"도메인 외" 판단 기준 강화**: 금융/증권/투자와 관계없는 질문만 거절 (날씨, 맛집 등)

**기대 효과**: 오탐 236건 → ~100건 (-58%)

### 5.3 🟡 [단기] Type C "범위 넓어" 응답 세분화

**문제**: 모든 매칭 실패를 동일 템플릿으로 처리  
**솔루션**: 실패 원인별 차등 응답

| 원인 | 현재 | 개선 |
|------|------|------|
| 1~5자 입력 | "범위가 넓어..." | "어떤 종목에 대해 궁금하신가요? 종목명을 포함해 질문해 주세요." |
| 종목 데이터 없음 | "범위가 넓어..." | "[종목명]에 대한 데이터가 현재 제공되지 않습니다. 다른 종목이나 관련 ETF를 안내드릴까요?" |
| 세션 내 맥락 부족 | "범위가 넓어..." | 이전 대화 참조 후 맥락 보충 시도 |
| 실제 범위 넓음 | "범위가 넓어..." | 유지하되, 2~3가지 구체적 방향 선택지 제공 |

### 5.4 🟡 [단기] Type D 오타/축약어 보정 기능

**문제**: "시가퐁액"→"시가총액" 수준의 보정 불가  
**솔루션**:

1. **한글 자모 편집 거리** 기반 오타 보정 (Levenshtein distance 변형)
2. **증권 도메인 약어 사전**: "시총"→"시가총액", "ISA"→"개인종합자산관리계좌"
3. **세션 컨텍스트 참조**: "네"/"그래" 등 단답은 이전 질문의 연장으로 처리

### 5.5 🟠 [중기] Type E 응답 최소 품질 게이트

**문제**: 종목명만 반환하고 종료  
**솔루션**:

1. **응답 품질 검증 레이어** 추가:
   - 사용자가 "분석해줘"인데 응답 100자 미만 → 재생성 트리거
   - 사용자가 "전망"/"목표주가"인데 숫자 데이터 없음 → 데이터 재조회

2. **Minimum Response Contract**:
   ```
   분석 요청 → 최소 300자 + 데이터 테이블 1개
   종목 조회 → 최소 현재가 + 등락률 + 최근 뉴스 1건
   용어 설명 → 최소 100자 + 예시 1개
   ```

### 5.6 🟠 [중기] 반복 거절 방지 (Escalation Prevention)

**문제**: 동일 세션에서 같은 템플릿 3번 연속 → 극심한 불만  
**솔루션**:

1. **동일 템플릿 2회 이상 감지 시**: 다른 접근법으로 전환
   - "다른 방식으로 도움드리겠습니다. 구체적으로 어떤 정보가 필요하신가요?"
   - 선택지 제시: "1) 종목 재무 정보 2) 시장 동향 3) 거래 방법 안내"

2. **세션 내 불만 감지**: 욕설/반복질문 패턴 시 즉시 인간 상담 연결 안내

### 5.7 📊 [장기] 모니터링 자동화

1. **일일 실패율 대시보드**: 유형별 실패 건수/비율 트렌드
2. **오탐률 추적**: 주기적 샘플링 → 수동 라벨링 → 오탐률 측정
3. **사후 불만 알림**: 실패 응답 후 5분 내 부정 키워드 감지 시 Slack 알림
4. **A/B 테스트**: 개선된 템플릿 vs 기존 템플릿 만족도 비교

---

## 6. 우선순위 로드맵

```
Week 1-2: [Critical]
  ├── Type A: Intent Classification 로직 도입
  ├── Type B: 금융 도메인 화이트리스트 확장
  └── 반복 거절 방지 로직 (동일 세션 2회 이상)

Week 3-4: [High]
  ├── Type C: 실패 원인별 차등 응답 구현
  ├── Type D: 오타 보정 + 약어 사전
  └── 세션 컨텍스트 참조 기능

Month 2: [Medium]
  ├── Type E: 응답 최소 품질 게이트
  ├── 일일 모니터링 대시보드
  └── A/B 테스트 프레임워크

Month 3: [Long-term]
  ├── 오탐률 추적 파이프라인
  ├── 사후 불만 실시간 알림
  └── 지속적 개선 사이클
```

---

## 7. 부록: BigQuery 쿼리 (재현용)

### 전체 실패 건수 조회
```sql
SELECT
  CASE
    WHEN llm_response LIKE '죄송합니다. 저는 법률 및 내부 규정%' THEN 'A_투자추천거절'
    WHEN llm_response LIKE '죄송합니다. 저는 금융 및 투자 정보%'
      OR llm_response LIKE '> 죄송합니다. 저는 금융 및 투자 정보%'
      OR llm_response LIKE '죄송합니다. 저는 주식, 금융, 투자%'
      OR llm_response LIKE '> 죄송합니다. 저는 주식, 금융, 투자%' THEN 'B_도메인외거절'
    WHEN llm_response LIKE '%질문의 범위가 너무 넓어%' THEN 'C_범위넓어'
    WHEN llm_response LIKE '%입력하신 내용을 정확히 이해하지 못했습니다%' THEN 'D_이해불가'
    WHEN LENGTH(llm_response) <= 50 THEN 'E_짧은응답'
    ELSE 'OK'
  END as fail_type,
  COUNT(*) as cnt,
  ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM `finola-global.ola_monitoring.view_ola_monitoring` WHERE timestamp >= TIMESTAMP('2026-01-27')), 2) as pct
FROM `finola-global.ola_monitoring.view_ola_monitoring`
WHERE timestamp >= TIMESTAMP('2026-01-27')
GROUP BY fail_type
ORDER BY cnt DESC;
```

### 사후 불만 감지
```sql
SELECT
  a.user_input as original_question,
  SUBSTR(a.llm_response, 1, 80) as bot_response,
  b.user_input as follow_up,
  DATE(a.timestamp) as date
FROM `finola-global.ola_monitoring.view_ola_monitoring` a
JOIN `finola-global.ola_monitoring.view_ola_monitoring` b
  ON a.request_metadata.session_id = b.request_metadata.session_id
  AND b.timestamp > a.timestamp
  AND TIMESTAMP_DIFF(b.timestamp, a.timestamp, MINUTE) <= 5
WHERE a.timestamp >= TIMESTAMP('2026-01-27')
  AND (a.llm_response LIKE '죄송합니다. 저는 법률 및 내부 규정%'
    OR a.llm_response LIKE '죄송합니다. 저는 금융 및 투자 정보%'
    OR a.llm_response LIKE '%질문의 범위가 너무 넓어%'
    OR a.llm_response LIKE '%입력하신 내용을 정확히 이해하지 못했습니다%')
  AND REGEXP_CONTAINS(LOWER(b.user_input), r'(아니|틀|다시|제대로|왜|답답|짜증|시발|ㅅㅂ|ㅂㅅ)')
ORDER BY a.timestamp DESC;
```

---

*보고서 생성: 2026-02-19 | 데이터 기준: BigQuery view_ola_monitoring*
